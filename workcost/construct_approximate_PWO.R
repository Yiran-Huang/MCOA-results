a=c(2,5,3,1,6,4,1,5,3,2,4,6,6,5,1,4,2,3,
    6,3,4,5,2,1,5,1,6,4,3,2,3,2,6,4,5,1,
    5,6,4,3,1,2,1,4,5,3,2,6,4,3,5,1,6,2,
    2,4,6,5,3,1,5,2,1,6,3,4,2,1,4,6,3,5,
    4,1,5,2,3,6,4,2,3,5,6,1,4,6,2,1,5,3,
    5,1,3,2,6,4,6,4,5,3,1,2,4,2,3,1,5,6,
    4,1,3,6,2,5,4,3,2,1,6,5,5,4,3,6,2,1,
    1,4,5,6,3,2,3,1,5,2,6,4,3,1,2,5,4,6,
    3,1,6,5,2,4,4,6,1,5,2,3,6,1,2,4,5,3,
    5,3,4,6,2,1,5,6,2,4,3,1,4,1,5,6,3,2,
    3,6,1,4,2,5,2,1,5,3,6,4,1,5,2,3,6,4,
    2,6,1,5,4,3,1,2,4,3,6,5,3,4,6,2,5,1,
    6,1,2,3,5,4,6,1,3,2,5,4,5,1,3,4,2,6,
    3,2,4,1,5,6,5,1,4,3,6,2,2,1,3,4,5,6,
    3,5,1,4,2,6,2,6,5,3,1,4,3,1,4,6,5,2,
    2,4,3,5,6,1,5,4,2,6,1,3,4,2,5,6,1,3)
a=matrix(a,ncol=18,byrow=TRUE)
a=a[,1:6]
x=a-1

substi<-function(x,a){
  m=length(a)
  for(i in m:1){
    x[x==(i-1)]=a[i]
  }
  return(x)
}

H=c(
  1, -1, -1, -1,   -1, -1, -1, -1,  -1, -1, -1, -1,
  1,  1, -1,  1,   -1, -1, -1,  1,   1,  1, -1,  1,
  1,  1,  1, -1,    1, -1, -1, -1,   1,  1,  1, -1,
  1, -1,  1,  1,   -1,  1, -1, -1,  -1,  1,  1,  1,
  
  1,  1, -1,  1,    1, -1,  1, -1,  -1, -1,  1,  1,
  1,  1,  1, -1,    1,  1, -1,  1,  -1, -1, -1,  1,
  1,  1,  1,  1,   -1,  1,  1, -1,   1, -1, -1, -1,
  1, -1,  1,  1,    1, -1,  1,  1,  -1,  1, -1, -1,
  
  1, -1, -1,  1,    1,  1, -1,  1,   1, -1,  1, -1,
  1, -1, -1, -1,    1,  1,  1, -1,   1,  1, -1,  1,
  1,  1, -1, -1,   -1,  1,  1,  1,  -1,  1,  1, -1,
  1, -1,  1, -1,   -1, -1,  1,  1,   1, -1,  1,  1)
H=matrix(H,ncol=12,byrow=TRUE)
H[,2:12]=-H[,2:12]
H=H[-1,]


D=c()
list_use=list()
for(b in 1:11){
  for(j in 1:1){
    flag=TRUE
    now_use=which(H[b,]==1)-1
    now_use=sort(now_use)
    now_use_inv=setdiff(0:11,now_use)
    if(b>1){
      for(i in 1:length(list_use)){
        if(mean(list_use[[i]]==now_use)==1 || mean(list_use[[i]]==now_use_inv)==1){flag=FALSE}
      }}
    if(flag){
      list_use=c(list_use,list(now_use))
    }
  }
  Bu=substi(x,now_use)
  Bu_hat=substi(x,now_use_inv)
  D=rbind(D,rbind(cbind(Bu,Bu_hat),cbind(Bu_hat[,c(rev(1:6))],Bu)))
}

Dnew=matrix(nrow=nrow(D),ncol=11)
for(i in 1:nrow(Dnew)){
  loc=which(D[i,]==11)
  Dnew[i,]=D[i,-loc]
}
D=Dnew


p=choose(11,2)+1
q=p-1

D_loc=component_2_location(D+1)
D_PWO=location_2_PWOdesign(D_loc)
det(t(D_PWO)%*%D_PWO/length(D[,1]))^(1/p)

((11+1)^(11-1)/3^q)^(1/p)

